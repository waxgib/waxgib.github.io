<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEVELE</title>
    <style>
        html,body {
            height:100%;
            background-color:white;
        }
        table {
            border-collapse: collapse;
            border: none;
            font-family: verdana;
            font-size: 40px;
        }
    </style>
</head>
<body>
    <table id="taba" width="100%" height="100%" onclick="hit()">
        <tr><td colspan="3"</td><td>RESET</td></tr>
        <tr><td>0</td><td>0</td><td>0</td><td>HOLD</td></tr>
        <tr><td>0</td><td>0</td><td>0</td><td>HOLD</td></tr>
        <tr><td>0</td><td>0</td><td>0</td><td>HOLD</td></tr>
        <tr><td>0</td><td>0</td><td>0</td><td>HOLD</td></tr>
    </table>
    <!--script src="cola.js"></script-->
    <script>
        // to get console in safari, option+command+c
        let asgt = 0
        let asnr = 0
        let asng = 0
        let asnb = 0
        let asny = 0
        let asor = 0
        let asog = 0
        let asob = 0
        let asoy = 0
        let asot = 0
        let ashr = 0
        let ashg = 0
        let ashb = 0
        let ashy = 0
        reset()
        asgt += 1
        topup()
        show()
        //let asran = Math.floor(Math.random() * 4);
        //let asrgb = 'rgb(${asr}, ${asg}, ${asb})';
        //console.log(asr, asg, asb, asrgb);

        //document.getElementById("taba").style.color = "orange";
        document.getElementById('taba').rows[0].cells[0].style.backgroundColor = "rgb(192,192,192)";
        document.getElementById('taba').rows[0].cells[1].style.backgroundColor = "rgb(192,192,192)";
        document.getElementById('taba').rows[1].cells[0].style.backgroundColor = "rgb(255,128,128)";
        document.getElementById('taba').rows[1].cells[1].style.backgroundColor = "rgb(255,128,128)";
        document.getElementById('taba').rows[1].cells[2].style.backgroundColor = "rgb(255,128,128)";
        document.getElementById('taba').rows[1].cells[3].style.backgroundColor = "rgb(255,128,128)";
        document.getElementById('taba').rows[2].style.backgroundColor = "rgb(128,255,128)";
        document.getElementById('taba').rows[3].style.backgroundColor = "rgb(192,192,255)";
        document.getElementById('taba').rows[4].style.backgroundColor = "rgb(255,255,128)";
        function hit() {
            //document.getElementById('taba').rows[0].cells[0].style.backgroundColor = 'orange';
            console.log('hit');
        }
        function reset() {
            asgt = -1
            asnr = 0
            asng = 0
            asnb = 0
            asny = 0
            asor = 0
            asog = 0
            asob = 0
            asoy = 0
            asot = 0
            ashr = 0
            ashg = 0
            ashb = 0
            ashy = 0
        }
        function topup() {
            asimax = 16 - asot
            console.log('asot', asot, asor, asog, asob, asoy, asimax);
            for (let i = 0; i < asimax; i++) {
                console.log('topup', i, asot, asor, asog, asob, asoy);
                let asran = Math.floor(Math.random() * 4);
                if (asran == 0) {if (ashr == 0) {asor+=1} else {asot -= 1, i -= 1}}
                if (asran == 1) {if (ashg == 0) {asog+=1} else {asot -= 1, i -= 1}}
                if (asran == 2) {if (ashb == 0) {asob+=1} else {asot -= 1, i -= 1}}
                if (asran == 3) {if (ashy == 0) {asoy+=1} else {asot -= 1, i -= 1}}
                asot += 1
                console.log('asran', i, asot, asor, asog, asob, asoy, asran);
            }
            //asot = 16
        }
        function show() {
            aspr = asnr + asor
            aspg = asng + asog
            aspb = asnb + asob
            aspy = asny + asoy
            ashtr = 'HOLD'
            if (ashr == 1) {ashtr = 'held'}
            ashtg = 'HOLD'
            if (ashg == 1) {ashtg = 'held'}
            ashtb = 'HOLD'
            if (ashb == 1) {ashtb = 'held'}
            ashty = 'HOLD'
            if (ashy == 1) {ashty = 'held'}
            document.getElementById('taba').rows[0].cells[0].innerHTML = asgt;
            document.getElementById('taba').rows[0].cells[1].innerHTML = 'RESET';
            document.getElementById('taba').rows[1].cells[0].innerHTML = asnr;
            document.getElementById('taba').rows[1].cells[1].innerHTML = '+' + asor;
            document.getElementById('taba').rows[1].cells[2].innerHTML = '=' + aspr;
            document.getElementById('taba').rows[1].cells[3].innerHTML = ashtr;
            document.getElementById('taba').rows[2].cells[0].innerHTML = asng;
            document.getElementById('taba').rows[2].cells[1].innerHTML = '+' + asog;
            document.getElementById('taba').rows[2].cells[2].innerHTML = '=' + aspg;
            document.getElementById('taba').rows[2].cells[3].innerHTML = ashtg;
            document.getElementById('taba').rows[3].cells[0].innerHTML = asnb;
            document.getElementById('taba').rows[3].cells[1].innerHTML = '+' + asob;
            document.getElementById('taba').rows[3].cells[2].innerHTML = '=' + aspb;
            document.getElementById('taba').rows[3].cells[3].innerHTML = ashtb;
            document.getElementById('taba').rows[4].cells[0].innerHTML = asny;
            document.getElementById('taba').rows[4].cells[1].innerHTML = '+' + asoy;
            document.getElementById('taba').rows[4].cells[2].innerHTML = '=' + aspy;
            document.getElementById('taba').rows[4].cells[3].innerHTML = ashty;
        }
        document.querySelector('#taba')
            .addEventListener('click', (ev) => {
                const [x, y] = [
                ev.target.cellIndex, 
                ev.target.parentElement.rowIndex
                ];
                if (x === undefined || y === undefined) {
                // Clicked on space between cells
                return;
                }
                console.log('click', x, y);
                if (y == 0 & x == 1) {reset()}
                if (y == 1 & x == 3) {if (ashr == 0) {ashr = 1} else {ashr = 0}}
                if (y == 2 & x == 3) {if (ashg == 0) {ashg = 1} else {ashg = 0}}
                if (y == 3 & x == 3) {if (ashb == 0) {ashb = 1} else {ashb = 0}}
                if (y == 4 & x == 3) {if (ashy == 0) {ashy = 1} else {ashy = 0}}
                if (y == 1 & x <= 2) {asnr += asor, asot -= asor, asor = 0}
                if (y == 2 & x <= 2) {asng += asog, asot -= asog, asog = 0}
                if (y == 3 & x <= 2) {asnb += asob, asot -= asob, asob = 0}
                if (y == 4 & x <= 2) {asny += asoy, asot -= asoy, asoy = 0}
                if (asot < 16) {
                    asgt += 1
                    topup()
                }
                if (ashr == 1 & ashg == 1 & ashb == 1 & ashy == 1) {ashr = 0, ashg = 0, ashb = 0, ashy = 0}
                // victory?
                //if (Math.min(asnr, asng) )
                show()
                console.log(x, y, ashr, ashtr)

                //console.log(x, y, asr, asg, asb);
            });
    </script>
</body>
</html>
